import{M as $,_ as V}from"./bootstrap.esm-C-lFR8I3.js";import{_ as B}from"./Tabulator.vue_vue_type_style_index_0_lang-B0UUua3P.js";import{g as L,r as M,u as q,d as A,a as E}from"./repository-Bud0f_L3.js";import{d as P,u as x,r as p,c as T,w as S,o as U,a as N,b as e,t as D,e as f,g as I,x as b,h as F,D as _,i as C}from"./index-D_LidmWq.js";const G={class:"modal-dialog modal-lg",role:"document"},O={class:"modal-content"},j={class:"modal-header"},z={class:"modal-title"},H={class:"modal-body py-4"},J={class:"row mb-3"},K=["disabled"],Q={class:"mb-3"},W={class:"form-check form-check-inline"},X=["disabled"],Y={class:"form-check form-check-inline"},Z=["disabled"],ee={class:"mb-3"},te={class:"form-check form-check-inline"},oe={class:"form-check form-check-inline"},le={class:"form-check form-check-inline"},se={class:"mb-3"},ae={class:"form-check form-check-inline"},ne={class:"form-check form-check-inline"},re={class:"modal-footer"},ie=P({__name:"repositoryForm",props:{mode:{},repositoryName:{}},emits:["get-repository-list"],setup(k,{emit:g}){const r=x(),m=p(),c=p(),i=k,v=g,a=T(()=>i.repositoryName);S(a,async()=>{await w()}),U(async()=>{m.value&&(c.value=new $(m.value)),await w()});const o=p({}),u=p(""),h=p(0),y=p(0),w=async()=>{if(i.mode==="new")o.value.name="",o.value.format="helm",o.value.type="hosted",o.value.url="",o.value.online=!0,h.value=0,y.value=0,u.value="allow";else{const{data:l}=await L("nexus",i.repositoryName);o.value=l,u.value=l.storage.writePolicy,l.format=="docker"&&(h.value=l.docker.httpPort,y.value=l.docker.httpsPort)}},n=async()=>{if(!o.value.name||o.value.name.trim()===""){r.error("Please enter repository name.");return}if(!o.value.format){r.error("Please select format.");return}if(!u.value){r.error("Please select allow policy.");return}if(o.value.online===void 0||o.value.online===null){r.error("Please select online/offline status.");return}o.value.storage={blobStoreName:"default",strictContentTypeValidation:!0,writePolicy:u.value},o.value.format!="docker"?o.value.docker={}:o.value.docker={v1Enabled:!0,forceBasicAuth:!0,httpPort:h.value,httpsPort:y.value,subdomain:"/test"};let l=!1;i.mode==="new"?l=await d():l=await R(),l&&(v("get-repository-list"),w(),c.value&&(c.value.hide(),setTimeout(()=>{document.body.classList.remove("modal-open");const t=document.querySelector(".modal-backdrop");t==null||t.remove()},150)))},d=async()=>{try{const{data:l}=await M("nexus",o.value);return l?(r.success("Repository created successfully."),!0):(r.error("Failed to create repository."),!1)}catch{return r.error("Failed to create repository."),!1}},R=async()=>{try{const{data:l}=await q("nexus",o.value);return l?(r.success("Repository updated successfully."),!0):(r.error("Failed to update repository."),!1)}catch{return r.error("Failed to update repository."),!1}};return(l,t)=>(F(),N("div",{class:"modal fade",id:"repositoryForm",tabindex:"-1",ref_key:"modalElement",ref:m},[e("div",G,[e("div",O,[e("div",j,[e("h3",z,"Repository "+D(i.mode==="new"?"Create":"Update"),1),t[10]||(t[10]=e("button",{type:"button",class:"btn-close","data-bs-dismiss":"modal","aria-label":"Close"},null,-1))]),e("div",H,[e("div",null,[e("div",J,[t[11]||(t[11]=e("label",{class:"form-label required"},"Name",-1)),f(e("input",{type:"text",class:"form-control p-2 g-col-11","onUpdate:modelValue":t[0]||(t[0]=s=>o.value.name=s),disabled:i.mode!="new",placeholder:"Enter repository name"},null,8,K),[[I,o.value.name]])]),e("div",Q,[t[14]||(t[14]=e("label",{class:"form-label required"},"Format",-1)),e("div",null,[e("label",W,[f(e("input",{class:"form-check-input",type:"radio",name:"format",value:"helm","onUpdate:modelValue":t[1]||(t[1]=s=>o.value.format=s),disabled:i.mode!="new"},null,8,X),[[b,o.value.format]]),t[12]||(t[12]=e("span",{class:"form-check-label"},"helm",-1))]),e("label",Y,[f(e("input",{class:"form-check-input",type:"radio",name:"format",value:"docker","onUpdate:modelValue":t[2]||(t[2]=s=>o.value.format=s),disabled:i.mode!="new"},null,8,Z),[[b,o.value.format]]),t[13]||(t[13]=e("span",{class:"form-check-label"},"docker",-1))])])]),e("div",ee,[t[18]||(t[18]=e("label",{class:"form-label required"},"Allow",-1)),e("div",null,[e("label",te,[f(e("input",{class:"form-check-input",type:"radio",name:"allow",value:"allow","onUpdate:modelValue":t[3]||(t[3]=s=>u.value=s)},null,512),[[b,u.value]]),t[15]||(t[15]=e("span",{class:"form-check-label"},"allow",-1))]),e("label",oe,[f(e("input",{class:"form-check-input",type:"radio",name:"allow",value:"allow_once","onUpdate:modelValue":t[4]||(t[4]=s=>u.value=s)},null,512),[[b,u.value]]),t[16]||(t[16]=e("span",{class:"form-check-label"},"allow_once",-1))]),e("label",le,[f(e("input",{class:"form-check-input",type:"radio",name:"allow",value:"deny","onUpdate:modelValue":t[5]||(t[5]=s=>u.value=s)},null,512),[[b,u.value]]),t[17]||(t[17]=e("span",{class:"form-check-label"},"deny",-1))])])]),e("div",se,[t[21]||(t[21]=e("label",{class:"form-label required"},"On/Offline",-1)),e("div",null,[e("label",ae,[f(e("input",{class:"form-check-input",type:"radio",name:"online",value:"true","onUpdate:modelValue":t[6]||(t[6]=s=>o.value.online=s)},null,512),[[b,o.value.online]]),t[19]||(t[19]=e("span",{class:"form-check-label"},"true",-1))]),e("label",ne,[f(e("input",{class:"form-check-input",type:"radio",name:"online",value:"false","onUpdate:modelValue":t[7]||(t[7]=s=>o.value.online=s)},null,512),[[b,o.value.online]]),t[20]||(t[20]=e("span",{class:"form-check-label"},"false",-1))])])])])]),e("div",re,[e("button",{type:"button",class:"btn btn-link link-secondary","data-bs-dismiss":"modal",onClick:t[8]||(t[8]=s=>w())}," Cancel "),e("button",{type:"button",ref:"submitBtn",class:"btn btn-primary ms-auto",onClick:t[9]||(t[9]=s=>n())},D(i.mode==="new"?"Create":"Update"),513)])])])],512))}}),de={class:"modal fade",id:"deleteRepository",tabindex:"-1"},ue={class:"modal-dialog modal-lg",role:"document"},me={class:"modal-content"},ce={class:"modal-body text-left py-4"},pe={class:"modal-footer"},fe=P({__name:"deleteRepository",props:{repositoryName:{}},emits:["get-repository-list"],setup(k,{emit:g}){const r=x(),m=k,c=g,i=async()=>{const{data:v}=await A("nexus",m.repositoryName);v?r.success("Deleted successfully."):r.error("Failed to delete."),c("get-repository-list")};return(v,a)=>(F(),N("div",de,[e("div",ue,[e("div",me,[a[3]||(a[3]=e("button",{type:"button",class:"btn-close","data-bs-dismiss":"modal","aria-label":"Close"},null,-1)),a[4]||(a[4]=e("div",{class:"modal-status bg-danger"},null,-1)),e("div",ce,[a[1]||(a[1]=e("h3",{class:"mb-5"}," Delete Repository ",-1)),e("h4",null,"Are you sure you want to delete "+D(m.repositoryName)+"?",1)]),e("div",pe,[a[2]||(a[2]=e("a",{href:"#",class:"btn btn-link link-secondary","data-bs-dismiss":"modal"}," Cancel ",-1)),e("a",{href:"#",class:"btn btn-primary ms-auto","data-bs-dismiss":"modal",onClick:a[0]||(a[0]=o=>i())}," Delete ")])])])]))}}),ve={class:"card card-flush w-100"},ge=P({__name:"RepositoryList",props:{embedded:{type:Boolean}},emits:["open-detail"],setup(k,{emit:g}){const r=x(),m=k,c=g,i=p([]),v=p([]);U(async()=>{u(),await a()});const a=async()=>{try{const{data:n}=await E("nexus");i.value=n}catch(n){console.log(n),r.error("Unable to fetch data.")}},o=p(""),u=()=>{v.value=[{title:"Name",field:"name",width:"15%",cellClick:function(n,d){n.stopPropagation(),o.value=d.getRow().getData().name,m.embedded?c("open-detail",o.value):_.push("/web/repository/detail/"+o.value)}},{title:"Format",field:"format",width:"10%",cellClick:function(n,d){n.stopPropagation(),o.value=d.getRow().getData().name,m.embedded?c("open-detail",o.value):_.push("/web/repository/detail/"+o.value)}},{title:"URL",field:"url",width:"40%",cellClick:function(n,d){n.stopPropagation(),o.value=d.getRow().getData().name,m.embedded?c("open-detail",o.value):_.push("/web/repository/detail/"+o.value)}},{title:"Type(hosted)",field:"type",width:"15%",cellClick:function(n,d){n.stopPropagation(),o.value=d.getRow().getData().name,m.embedded?c("open-detail",o.value):_.push("/web/repository/detail/"+o.value)}},{title:"Action",width:"20%",formatter:h,cellClick:function(n,d){const R=n.target,l=R==null?void 0:R.getAttribute("id");o.value=d.getRow().getData().name,l==="edit-btn"?y.value="edit":o.value=d.getRow().getData().name}}]},h=()=>`
  <div>
    <button
      class='btn btn-outline-primary d-none d-sm-inline-block me-1'
      id='edit-btn'
      data-bs-toggle='modal' 
      data-bs-target='#repositoryForm'>
      Update
    </button>
    <button
      class='btn btn-outline-danger d-none d-sm-inline-block'
      id='delete-btn'
      data-bs-toggle='modal' 
      data-bs-target='#deleteRepository'>
      Delete
    </button>
  </div>`,y=p("new"),w=()=>{o.value="",y.value="new"};return(n,d)=>(F(),N("div",ve,[C(V,{"header-title":"Repository","new-btn-title":"New Repository","popup-flag":!0,"popup-target":"#repositoryForm",onClickNewBtn:w}),C(B,{columns:v.value,"table-data":i.value},null,8,["columns","table-data"]),C(ie,{mode:y.value,"repository-name":o.value,onGetRepositoryList:a},null,8,["mode","repository-name"]),C(fe,{"repository-name":o.value,onGetRepositoryList:a},null,8,["repository-name"])]))}});export{ge as _};
