import{d as C,u as D,a as $,b as t,t as B,h as N,o as x,r as c,e as y,g as w,E as I,w as L,i as _,G as A}from"./index-C3961WmP.js";import{b as S,c as z,g as E,e as P}from"./repository-DiQkV1oi.js";import{_ as q}from"./lodash-RVlGbuBg.js";import{_ as G}from"./Tabulator.vue_vue_type_style_index_0_lang-Bod1ZbpA.js";const T={class:"modal fade",id:"deleteComponent",tabindex:"-1"},M={class:"modal-dialog modal-lg",role:"document"},K={class:"modal-content"},j={class:"modal-body text-left py-4"},H={class:"modal-footer"},J=C({__name:"deleteComponent",props:{componentName:{},componentId:{}},emits:["get-detail"],setup(b,{emit:f}){const d=D(),r=b,i=f,m=async()=>{const{data:l}=await S("nexus",r.componentId);l?d.success("Deleted successfully."):d.error("Failed to delete."),i("get-detail")};return(l,a)=>(N(),$("div",T,[t("div",M,[t("div",K,[a[3]||(a[3]=t("button",{type:"button",class:"btn-close","data-bs-dismiss":"modal","aria-label":"Close"},null,-1)),a[4]||(a[4]=t("div",{class:"modal-status bg-danger"},null,-1)),t("div",j,[a[1]||(a[1]=t("h3",{class:"mb-5"}," Delete Component ",-1)),t("h4",null,"Are you sure you want to delete "+B(r.componentName)+"?",1)]),t("div",H,[a[2]||(a[2]=t("a",{href:"#",class:"btn btn-link link-secondary","data-bs-dismiss":"modal"}," Cancel ",-1)),t("a",{href:"#",class:"btn btn-primary ms-auto","data-bs-dismiss":"modal",onClick:a[0]||(a[0]=v=>m())}," Delete ")])])])]))}}),O={class:"modal fade",id:"uploadComponent",tabindex:"-1"},Q={class:"modal-dialog modal-lg",role:"document"},W={class:"modal-content"},X={class:"modal-body text-left py-4"},Y={class:"mb-3"},Z=["value"],tt={class:"mb-3"},et=["disabled"],ot={class:"mb-3"},st={class:"grid gap-0 column-gap-3"},lt={class:"modal-footer"},at=C({__name:"uploadComponent",props:{repositoryName:{},format:{}},emits:["get-detail"],setup(b,{emit:f}){const d=D(),r=b,i=f;x(()=>{p()});const m=c("/"),l=c([]),a=u=>{l.value=u.target.files[0]},v=async()=>{if(r.format=="raw"&&q.isEmpty(m.value)){d.error("Please enter the path.");return}if(l.value.length==0){d.error("No file selected.");return}const u=new FormData;u.append("assets",l.value),u.append("directory",m.value);const{data:s}=await z("nexus",r.repositoryName,u);s?d.success("Uploaded successfully."):d.error("Failed to upload."),i("get-detail")},p=()=>{m.value="/",l.value=[]};return(u,s)=>(N(),$("div",O,[t("div",Q,[t("div",W,[s[7]||(s[7]=t("button",{type:"button",class:"btn-close","data-bs-dismiss":"modal","aria-label":"Close"},null,-1)),t("div",X,[s[5]||(s[5]=t("h3",{class:"mb-5"}," File Upload ",-1)),t("div",null,[t("div",Y,[s[2]||(s[2]=t("label",{class:"form-label"},"Name",-1)),t("input",{type:"text",class:"form-control p-2 g-col-11",value:r.repositoryName,readonly:""},null,8,Z)]),t("div",tt,[s[3]||(s[3]=t("label",{class:"form-label"},"Path",-1)),y(t("input",{type:"text",class:"form-control p-2 g-col-11","onUpdate:modelValue":s[0]||(s[0]=g=>m.value=g),disabled:r.format!="raw"},null,8,et),[[w,m.value]])]),t("div",ot,[s[4]||(s[4]=t("label",{class:"form-label required"},"File",-1)),t("div",st,[t("input",{type:"file",class:"form-control p-2 g-col-11",onChange:a},null,32)])])])]),t("div",lt,[s[6]||(s[6]=t("a",{href:"#",class:"btn btn-link link-secondary","data-bs-dismiss":"modal"}," Cancel ",-1)),t("a",{href:"#",class:"btn btn-primary ms-auto","data-bs-dismiss":"modal",onClick:s[1]||(s[1]=g=>v())}," Upload ")])])])]))}}),nt={class:"card w-100",ref:"workflowForm"},it={class:"card-body"},dt={class:"card-title"},rt={class:"mb-3"},mt={class:"grid gap-0 column-gap-3"},ut={class:"mb-3"},ct={class:"grid gap-0 column-gap-3"},pt={class:"mb-3"},bt={class:"grid gap-0 column-gap-3"},ft={class:"mb-3"},vt={class:"grid gap-0 column-gap-3"},gt={class:"mb-3"},Dt=C({__name:"RepositoryDetail",props:{embedded:{type:Boolean},repositoryName:{}},emits:["back-to-list"],setup(b,{emit:f}){D();const d=I(),r=A(),i=b,m=f,l=c({}),a=c([]),v=c([]);x(async()=>{h(),i.embedded||await p()});const p=async n=>{const e=d.params.repositoryName,o=n??(i.embedded?i.repositoryName:e);if(!o)return;const{data:k}=await E("nexus",o);l.value=k,await u()};L(()=>i.repositoryName,async n=>{i.embedded&&n&&await p(n)},{immediate:!0});const u=async()=>{const{data:n}=await P("nexus",l.value.name);a.value=n},s=c(""),g=c(""),h=()=>{v.value=[{title:"Name",field:"name",width:"15%"},{title:"URL(Path)",field:"assets",width:"50%",formatter:function(n){const e=n.getValue();return e&&e.length>0?e[0].downloadUrl:"N/A"}},{title:"Size",field:"assets",width:"15%",formatter:function(n){const e=n.getValue();return e&&e.length>0?`${(e[0].fileSize/1024).toFixed(2)} KB`:"N/A"}},{title:"Action",width:"20%",formatter:U,cellClick:function(n,e){const o=n.target;if((o==null?void 0:o.getAttribute("id"))==="download-btn"){console.log("download");let V=e.getRow().getData();F(V)}else s.value=e.getRow().getData().id,g.value=e.getRow().getData().name}}]},U=()=>`
  <div>
  <button
      class='btn btn-outline-danger d-none d-sm-inline-block'
      id='delete-btn'
      data-bs-toggle='modal' 
      data-bs-target='#deleteComponent'>
      Delete
    </button>
    <button
      class='btn btn-outline-primary d-none d-sm-inline-block me-1'
      id='download-btn'>
      Download
    </button>
  </div>`,F=n=>{const e=n.assets[0].downloadUrl,o=document.createElement("a");o.href=e,o.download="",document.body.appendChild(o),o.click(),document.body.removeChild(o)},R=()=>{i.embedded?m("back-to-list"):r.push("/web/repository/list")};return(n,e)=>(N(),$("div",nt,[e[9]||(e[9]=t("div",{class:"card-header"},[t("div",{class:"card-title"},[t("h1",null,"Repository Detail")])],-1)),t("div",it,[t("div",dt,[t("div",rt,[e[4]||(e[4]=t("label",{class:"form-label"},"Name",-1)),t("div",mt,[y(t("input",{type:"text",ref:"repositoryName",class:"form-control p-2 g-col-11","onUpdate:modelValue":e[0]||(e[0]=o=>l.value.name=o),disabled:""},null,512),[[w,l.value.name]])])]),t("div",ut,[e[5]||(e[5]=t("label",{class:"form-label"},"Format",-1)),t("div",ct,[y(t("input",{type:"text",ref:"repositoryFormat",class:"form-control p-2 g-col-11","onUpdate:modelValue":e[1]||(e[1]=o=>l.value.format=o),disabled:""},null,512),[[w,l.value.format]])])]),t("div",pt,[e[6]||(e[6]=t("label",{class:"form-label required"},"URL(Path)",-1)),t("div",bt,[y(t("input",{type:"text",ref:"repositoryFormat",class:"form-control p-2 g-col-11","onUpdate:modelValue":e[2]||(e[2]=o=>l.value.url=o),disabled:""},null,512),[[w,l.value.url]])])]),t("div",ft,[e[7]||(e[7]=t("label",{class:"form-label required"},"Type(hosted)",-1)),t("div",vt,[y(t("input",{type:"text",ref:"repositoryFormat",class:"form-control p-2 g-col-11","onUpdate:modelValue":e[3]||(e[3]=o=>l.value.type=o),disabled:""},null,512),[[w,l.value.type]])])]),t("div",gt,[_(G,{columns:v.value,"table-data":a.value},null,8,["columns","table-data"])]),t("div",{class:"row align-items-center"},[e[8]||(e[8]=t("div",{id:"gap",class:"col"},null,-1)),t("div",{class:"col-auto ms-auto"},[t("div",{class:"btn-list"},[t("button",{class:"btn btn-outline-primary",onClick:R}," Back to List ")])])])]),_(J,{"component-name":g.value,"component-id":s.value,onGetDetail:p},null,8,["component-name","component-id"]),_(at,{"repository-name":l.value.name,format:l.value.format,onGetDetail:p},null,8,["repository-name","format"])])],512))}});export{Dt as _};
